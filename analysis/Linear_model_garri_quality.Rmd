---
title: "Garri Functional Quality"
output: pdf_document
date: "2023-02-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
Oto_22_func<-read.csv("/Users/ca384/Documents/ChinedoziRepo/GarriQuality/data/OTOBI_2022PYT_FUNCTIONAL.csv", head=T) # data for Otobi wit swelling power, swelling indx, bulk density and water absorbing capacity for 2022

Umu_22_func<-read.csv("/Users/ca384/Documents/ChinedoziRepo/GarriQuality/data/UMU_2022_PYT_FUNCTIONAL.csv",head=T)# data for Umudike wit swelling power, swelling index, bulk density and water absorbing capacity for 2022

str(Oto_22_func)
str(Umu_22_func)
Oto_22_func$Genotype<-as.factor(Oto_22_func$Genotype)
Oto_22_func$wac.<-as.numeric(Oto_22_func$wac.)
Umu_22_func$Genotype<-as.factor(Umu_22_func$Genotype)
head(Umu_22_func)
head(Oto_22_func)
str(Oto_22_func)
str(Umu_22_func)
summary(Oto_22_func)
summary(Umu_22_func)
```

```{r creating plots}
boxplot(Oto_22_func$wac. , main="Water absorbing capacity of garri ",ylab = "WAC",xlab="Genotypes")

boxplot(Oto_22_func$wac. , main="Water absorbing capacity of garri ",ylab="WAC", xlab="Genotypes") #Removing outliers using the boxplot method

install.packages("ggplot2")
library(ggplot2)

par(mfrow=c(2,2))
boxplot(Oto_22_func$swelling.index, xlab="Genotypes", ylab="SI")
boxplot(Oto_22_func$swelling.power, ylab="SP",xlab="Genotypes")
boxplot(Oto_22_func$wac.,ylab="WAC", xlab="Genotypes")
boxplot(Oto_22_func$Bulk.Density, xlab="Genotypes", ylab="Bulk density")

```



```{r renamen a column and adding new colun for otobi and umudike}
library("dplyr") #Using rename()

colnames(Oto_22_func)
colnames(Umu_22_func)
Umu_22_func <- Umu_22_func %>% 
       rename(Bulk.Density = AverageBD) # rename bulk density

Umu_22_func <- Umu_22_func %>% 
       rename(WAC= wac.) # rename wac. to WAC
Umu_22_func <- Umu_22_func %>% 
       rename(swelling.index= Swelling.index) # rename wac. to WAC



Oto_22_func <- Oto_22_func %>% 
       rename(WAC= wac.) # rename wac. to WAC for otobi
```

```{r remove column sn and add column for year and location}
install.packages("tidyverse")
library(tidyverse)
Umu_22_func <-Umu_22_func %>%
  add_column(location = "Umudike", year="2022") # add column with location and year for Umudike
head(Umu_22_func)
Umu_22_func <- subset(Umu_22_func, select=-c(sn)) # Remove the sn
head(Umu_22_func)
Umu_22_func %>% relocate(location, year)

Oto_22_func <-Oto_22_func %>%
  add_column(location = "Otobi", year="2022")
Oto_22_func %>% relocate(location, year) # change the position of location and year from last column to the first column
```


```{r joining the two data frame}
Umu_oto_22 <-rbind(Oto_22_func, y=Umu_22_func)
View(Umu_oto_22)
str(Umu_oto_22)
Umu_oto_22$location<-as.factor(Umu_oto_22$location)
Umu_oto_22$year<-as.factor(Umu_oto_22$year)
str(Umu_oto_22)
summary(Umu_oto_22)
plot(Umu_oto_22)

```
```{r linear models}
install.packages("lme4")
install.packages("sommer")
install.packages("devtools")
install.packages("Hmisc")
library(lme4)
library(sommer)
library(Hmisc)
Umu_oto_corr<-round(cor(Umu_oto_22$swelling.index,Umu_oto_22$swelling.power,Umu_oto_22$WAC,Umu_oto_22$Bulk.Density, use="complete.obs"),3)

mod_1_WAC_aov <- lm(WAC ~ Genotype + location, Umu_oto_22)
summary(m2)
anova(m2)

mod_2_WAC_aov <- lmer(WAC ~ 1|Genotype + location, Umu_oto_22)

cor(WAC, swelling.index, data=Umu_oto_22)

#corrplot(corre.oto, type = "upper", order = "hclust",tl.col = "black" , tl.srt = 90,  cl.pos = "n")

#write.csv(corplot.oto,file=here("correlation.oto_new.csv"))

WAC<-lmer(data=Umu_oto_22, Genotype+location())


```

